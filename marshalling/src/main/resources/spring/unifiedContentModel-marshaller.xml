<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:oxm="http://www.springframework.org/schema/oxm"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
				http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
				http://www.springframework.org/schema/oxm http://www.springframework.org/schema/oxm/spring-oxm-3.0.xsd
				http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">
	
	<bean id="jaxbMarshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
		<property name="classesToBeBound" ref="classesToBeBound"/>
	    <property name="marshallerProperties">
	        <map>
	            <entry key="jaxb.encoding" value="UTF-8" />
	            <entry key="com.sun.xml.bind.namespacePrefixMapper" value-ref="responseNamespacePrefixMapper"/>
	       </map>
	    </property>
	</bean>
	
	<bean id="unifiedContentModelClassesToBeBound" class="org.springframework.beans.factory.config.ListFactoryBean">
	    <property name="sourceList">
	        <list>
				<value>com.ft.unifiedContentModel.model.ArticleEntity</value>
				<value>com.ft.unifiedContentModel.model.BlogEntity</value>
				<value>com.ft.unifiedContentModel.model.SimpleEntity</value>
				<value>com.ft.unifiedContentModel.model.ContentEntity</value>
				<value>com.ft.unifiedContentModel.model.StringBasedBody</value>
				<value>com.ft.unifiedContentModel.model.LifecycleImpl</value>
				<value>com.ft.unifiedContentModel.model.MasterImpl</value>
				<value>com.ft.unifiedContentModel.model.SummaryImpl</value>
				<value>com.ft.unifiedContentModel.model.TypeBasedImage</value>
				<value>com.ft.unifiedContentModel.model.AttributionImpl</value>
				<value>com.ft.unifiedContentModel.model.PackagingImpl</value>
				<value>com.ft.unifiedContentModel.model.LocationImpl</value>
				<value>com.ft.unifiedContentModel.model.EditorialImpl</value>
				<value>com.ft.unifiedContentModel.model.ProvenanceImpl</value>
				<value>com.ft.unifiedContentModel.model.TitleImpl</value>
				<value>com.ft.unifiedContentModel.model.MetadataImpl</value>
				<value>com.ft.unifiedContentModel.model.metadata.TermImpl</value>
				<value>com.ft.unifiedContentModel.model.metadata.TagImpl</value>
				<value>com.ft.unifiedContentModel.model.metadata.AttributeImpl</value>
				<value>com.ft.unifiedContentModel.model.response.AbstractResponse</value>
				<value>com.ft.unifiedContentModel.model.response.ItemResponse</value>
				<value>com.ft.unifiedContentModel.model.response.ItemsResponse</value>
			</list>
	    </property>
	</bean>
	
	<util:constant id="itemResponseNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.ITEM_RESPONSE_NAMESPACE"/>
	<util:constant id="itemResponseNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.ITEM_RESPONSE_NAMESPACE_PREFIX"/>
    <util:constant id="itemsResponseNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.ITEMS_RESPONSE_NAMESPACE"/>
	<util:constant id="itemsResponseNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.ITEMS_RESPONSE_NAMESPACE_PREFIX"/>
    <util:constant id="contentItemNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.CONTENTITEM_NAMESPACE"/>
	<util:constant id="contentItemNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.CONTENTITEM_NAMESPACE_PREFIX"/>
    <util:constant id="metadataNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.METADATA_NAMESPACE"/>
	<util:constant id="metadataNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.METADATA_NAMESPACE_PREFIX"/>
    <util:constant id="imageNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.IMAGE_NAMESPACE"/>
	<util:constant id="imageNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.IMAGE_NAMESPACE_PREFIX"/>
    <util:constant id="aspectNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.ASPECT_NAMESPACE"/>
	<util:constant id="aspectNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.ASPECT_NAMESPACE_PREFIX"/>
    <util:constant id="fieldNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.FIELD_NAMESPACE"/>
	<util:constant id="fieldNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.FIELD_NAMESPACE_PREFIX"/>
    <util:constant id="schemaInstanceNamespace"
                   static-field="com.ft.unifiedContentModel.model.XSDs.SCHEMAINSTANCE_NAMESPACE"/>
	<util:constant id="schemaInstanceNamespacePrefix"
                   static-field="com.ft.unifiedContentModel.model.XSDs.SCHEMAINSTANCE_NAMESPACE_PREFIX"/>
                   
	<bean id="unifiedContentModelNamespaceMappings" class="org.springframework.beans.factory.config.MapFactoryBean">
		<property name="sourceMap">
			<map>
				<entry>
					<key><ref bean="itemResponseNamespace"/></key>
					<ref bean="itemResponseNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="itemsResponseNamespace"/></key>
					<ref bean="itemsResponseNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="contentItemNamespace"/></key>
					<ref bean="contentItemNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="metadataNamespace"/></key>
					<ref bean="metadataNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="imageNamespace"/></key>
					<ref bean="imageNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="aspectNamespace"/></key>
					<ref bean="aspectNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="fieldNamespace"/></key>
					<ref bean="fieldNamespacePrefix"/>
				</entry>
				<entry>
					<key><ref bean="schemaInstanceNamespace"/></key>
					<ref bean="schemaInstanceNamespacePrefix"/>
				</entry>
			</map>
		</property>
	</bean>
	
	<bean id="responseNamespacePrefixMapper" class="com.ft.unifiedContentModel.marshalling.bind.ResponseNamespacePrefixMapper">
		<constructor-arg>
			<ref bean="responseNamespacePrefixMappings"/>
		</constructor-arg>
	</bean>	
	
	<!-- uses our own custom object mapper - includes jaxb and jackson annotation support and easy configuration -->
	<bean id="jaxbAndJacksonObjectMapper" class="com.ft.unifiedContentModel.marshalling.bind.JAXBandJacksonObjectMapper">
		<constructor-arg>
			<bean class="org.codehaus.jackson.map.AnnotationIntrospector.Pair">
				<constructor-arg>
					<bean class="org.codehaus.jackson.map.introspect.JacksonAnnotationIntrospector" />
				</constructor-arg>
				<constructor-arg>
					<bean class="com.ft.unifiedContentModel.marshalling.bind.CustomJaxbAnnotationIntrospector" />
				</constructor-arg>
			</bean>
		</constructor-arg>	
		<property name="prettyPrint" value="true"/>
		<property name="writeDatesAsTimestamps" value="false"/>
	</bean>

</beans>
